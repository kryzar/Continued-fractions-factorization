\subsection{Factorisation par fractions continues}

Dans tout le reste de cette section, $N$ désigne un entier naturel composé impair.

\subsubsection{Méthodes de Fermat et Kraitchik}

La méthode de factorisation de Fermat part du constat suivant.

\begin{lemme}
	Factoriser $N$ est équivalent à l'exprimer comme différence de deux carrés
	d'entiers.
\end{lemme}

\begin{proof}
	Si $N = u^2 - v^2, u, v\in \Z$ alors $N = (u-v)(u + v)$. Réciproquement si
	l'on a une factorisation $N = ab$, alors $N = \left(\frac{a+b}{2}\right)^2
	- \left(\frac{a-b}{2}\right)^2$.
\end{proof}

La méthode de Fermat exploite cette propriété et se montre particulièrement
efficace lorsque $N$ est le produit de deux entiers proches l'un de l'autre.
Notons $N=ab$ une factorisation de $N$ avec $a$ et $b$ proches, $r=\frac{a+b}{2}$,
$s=\frac{a-b}{2}$ de sorte que \[N = r^2 - s^2.\] Comme $s$ est petit en valeur
absolue par hypothèse, l'entier $r$ est donc plus grand que $\sqrt{N}$ tout en
lui étant proche. Il existe donc un entier positif $u$ \emph{pas trop grand} tel
que \[\ent{\sqrt{N}} + u = r\] et donc tel que $(\ent{\sqrt{N}} + u)^2 - N$ soit
un carré. Trouver un tel entier $u$ donne alors la factorisation de $N$. Comme 
les facteurs de $N$ sont proches l'un de l'autre, on le trouve par essais 
successifs. \\

La méthode de Fermat est cependant inefficace lorsque les facteurs de $N$ ne
sont pas proches. D'après \cite{Tale} ¶ \emph{Fermat and Kraitchik}, la méthode
est alors encore plus coûteuse que la méthode des divisions successives. Dans
les années 1920, Maurice Kraitchik a amélioré l'efficacité de la méthode de
Fermat. Son idée essentielle est que pour factoriser $N$, il \emph{suffit} de
trouver une différence de deux carrés qui soit un multiple de $N$.

\begin{lemme}
	Connaître deux entiers $u, v \in \Z$ tels que $u^2 \equiv v^2 
	\pmod{N}$ et $u\not\equiv \pm v\pmod{N}$ fournit une factorisation de $N$.
	Plus spécifiquement, les entiers $\pgcd(u-v, N)$ et $\pgcd(u+v, N)$ sont
	des facteurs non triviaux de $N$.
\end{lemme}

\begin{proof}
	Posons $g =\pgcd(u-v, N)$ et $g' = \pgcd(u+v, N)$. Comme $u\not\equiv \pm
	v\pmod{N}$, on a $g<N$ et $g'<N$. Enfin ni $g$ et $g'$ ne sont réduits à
	$1$ : si l'un deux l'est, l'autre vaut $N$, contradiction. Donc $g$ et $g'$
	sont tous deux des facteurs non triviaux de $N$.
\end{proof}

\begin{remarque}
	Dans l'algorithme, nous nous contenterons de chercher des $u, v$ tels que
	$N$ divise la différence de leurs carrés, sans vérifier s'ils vérifient $u
	\not\equiv \pm v\pmod{N}$. Comme le polynôme $X^2 - v^2 \in \Z/N\Z$ a
    exactement quatre racines, il y a \og{} une chance sur deux \fg{}  pour que
	$u$ et $v$ nous fournissent un facteur non trivial de $N$. \\
\end{remarque}

La factorisation de $N$ se fait donc en trouvant de tels couples $(u, v)$.
Kraitchik cherche pour cela des couples $(u_i, v_i)_{1\leq i \leq r}$ vérifiant
\[u_i^2 \equiv v_i \pmod{N}\] et tels que l'entier $\prod_{i=1}^r v_i$ soit un
carré (dans $\Z$). Posant $u = \prod_{i=1}^r u_i$ et $v = \sqrt{\prod_{i=1}^r
v_i}$, il vient \[v^2\equiv u^2 \pmod{N}.\] En se donnant des éléments $u_1,
\dots, u_r\in \Z$ et en posant $v_1 = K(u_1), \dots, v_r = K(u_r)$, où $K :=
X^2 - N \in \Z[X]$, on obtient $u_i^2 \equiv K(u_i) \pmod{N}$ pour tout
$u_i \in \Z$. Comment exhiber une sous-famille des $v_i, 1\leq i\leq r$ dont le
produit est un carré ?

\subsubsection{Recherche de congruences de carrés}

Morrison et Brillhart apportent dans l'article \NTS{ref} une réponse à cette
question. Leur méthode est basée sur la connaissance de congruences de la forme
\[u_i^2 \equiv Q_i \pmod{N},\] où $| Q_i |$ est suffisamment petit pour être 
factorisé. \footnote{La notation $Q_i$ fera échos à celle utilisée pour décrire
la méthode de factorisation avec les fractions continues.} 
On fixe pour cela $B$ une base de factorisation, c'est à dire un ensemble non 
vide fini de nombres premiers, et l'on dit qu'un entier $Q\in \N\setminus
\{0, 1\}$ est \emph{$B$-friable} si tous ses facteurs premiers sont dans $B$.
La connaissance de suffisamment d'entiers $Q_i$ qui sont $B$-friables permet
de factoriser $N$.

\begin{definition}
	Soient $B = \{p_1,\dots, p_m \}$ une base de factorisation et $Q\in \Z$ un
	entier dont la valeur absolue est $B$-friable. Q s'écrit alors 
    \[Q = (-1)^{v_0}\prod_{i=1}^m p_i^{v_{p_i}(Q)}.\] 
    Puisque les éléments de $B$ sont fixés et en nombre fini, l'élément
	$Q$ peut être vu comme le vecteur des valuations $(v_{p_m}(Q), \dots,
    v_{p_1}(Q), v_0 ) \in \mathbb{N}^{m+1}$. \\

    On appelle \emph{$B$-vecteur
	exposant de $Q$} et l'on note $v_B(Q)$ le vecteur
    \footnote{Notez qu'il 
    s'agit d'un élément de $\mathbb{F}_2^{m+1}$ : seule la parité des
    valuations nous intéresse. L'élément $v_0$ est placé à droite et non au 
    début car il correspondra au bit de poids faible du $B$-vecteur exposant
    dans le code.} 
     \[v_B(Q) :=
	(v_{p_m}(Q), \dots, v_{p_1}(Q), v_0 ) \in \mathbb{F}_2^{m+1}.\] 
\end{definition}

\begin{proposition}
	Soit $F$ une famille d'entiers dont les valeurs absolues sont $B$-friables.
	Si \[\# F \geqslant \# B + 2\] alors on peut extraire une sous-famille de
	$F$ dont le produit des éléments est un carré.
\end{proposition}

\begin{proof}
	Posons $F = \{Q_1, \dots, Q_k\}$ (de sorte que $k = \# F)$ et $B = (p_1,
	\dots, p_m)$ (de sorte que $\# B = m$). Par hypothèse de friabilité,
    on peut associer à chaque $Q_j$, $1\leqslant j \leqslant k$, un 
    $B$-vecteur exposant.\\

    Fixons $j, j'\in [\![1,k]\!]$. L'entier $Q_j$ est un carré \ssi les 
    composantes de son vecteur de valuations $(v_{p_m}(Q), \dots,
    v_{p_1}(Q), v_0 ) \in \mathbb{N}^{m+1}$ sont paires, i.e. si son 
    $B$-vecteur exposant est nul. Par propriété des valuations, le
    $B$-vecteur exposant associé au produit $Q_j\cdot Q_{j'}$ est le vecteur
    somme $v_B(Q_j) + v_B(Q_{j'})$. Autrement dit, le produit d'une sous-famille
    $\{Q_{j_1}, \dots, Q_{j_s}\}$ de $F$ est un carré \ssi la somme des 
    $B$-vecteurs exposants $v_B(Q_{j_1}), \dots, v_B(Q_{j_s})$ est nulle. Soit
    $V$ le $\mathbb{F}_2$-espace vectoriel $\mathbb{F}_2^{m+1}$, qui est de 
    dimension $m+1$. Comme $k\geqslant m+2$, la famille $\{v_B(Q_1), \dots,
    v_B(Q_k)\}$ est liée dans $V$ et il existe de fait des éléments $l_1,\dots,
    l_k\in \mathbb{F}_2$ tels que \[\sum_{j=1}^k l_j v_B(Q_j) = 0.\] L'élément
    $\prod_{j=1}^k Q_j^{l_j}$ est alors un carré.
\end{proof}

Étant données des congruences de la forme $u_i^2 \equiv Q_i \pmod{N}$, la
preuve de la proposition fournit un procédé d'algèbre linéaire pour extraire
une sous-famille des $Q_i$ dont le produit des éléments est un carré. On trouve
tout d'abord des $Q_{i_1}, \dots, Q_{i_k}$ dont la valeur absolue est
$B$-friable\footnote{Nous le ferons en factorisant les $Q_i$ à disposition par
divisions successives.}. Soit $M$ la matrice \[M := \begin{pmatrix}
v_B(Q_{i_1}) \\ \vdots \\ v_B(Q_{i_k})\end{pmatrix}\in \mathcal{M}_{k,
\#B+1}(\mathbb{F}_2).\] Soient $l_{1}, \dots, l_{k}$ les éléments de
$\mathbb{F}_2$ donnés dans la preuve de la proposition tels que \[\prod_{j=1}^k
Q_{i_j}^{l_{i_j}}\] est un carré. Le vecteur $(l_1, \dots, l_{k})$ est un
élément du noyau de la matrice transposée de $M$. Il peut donc être exhibé 
par pivot de Gau\ss{}.

\subsubsection{Utilisation des fractions continues}

L'introduction des fractions continues est motivée par le constat suivant. Si
\[u_i^2 = Q_i + kNb^2, \quad u_i, Q_i, b\in \Z, k\in \N^*\] de telle sorte que
$| Q_i |$ soit petit, alors \[\left(\frac{u_i}{b}\right)^2 - kN =
\frac{Q_i}{b^2}\] est petit en valeur absolue et $\frac{u_i}{b}$ est une bonne
approximation de $\sqrt{kN}$ \NTS{réf}. Fixons $k$ un entier naturel non nul,
posons $x = \sqrt{kN}$ et reprenons les notations \ref{notations} et celles
développées à la fin de la sous-section \ref{ss-irrquad}. En vertu de
l'identité \[A_{n-1}^2 \equiv (-1)^n Q_n \pmod{N},\] nous appelons
\emph{méthode de factorisation des fractions continues} la méthode de Kraitchik
dans laquelle les entiers $u_i$ sont donnés par les $A_{i-1}$ et les $v_i$ par
les $(-1)^i Q_i$. \\

Ce choix de congruences est intéressant car on sait que les $Q_n$ sont majorés
(\ref{inegalite}) par $2\sqrt{kN}$. A l'inverse, les $x^2 - N\in \Z[X], x\in \N$
ont une croissance linéaire de pente $2\sqrt{N}$ lorsque $x$ s'éloigne de 
$\sqrt{N}$. Pour une base de factorisation $B$ fixée, les $Q_n$ auront donc
plus de chance d'être $B$-friables que les $K(x)$ de Kraitchik. Or, l'étape la 
plus coûteuse de l'algorithme est celle de la recherche des termes $B$-friables
par divisions successives. Notons d'autre part qu'il est facile de générer le
développement en fraction continue de $x$ et les paires $(A_{n-1}, Q_n)$ grace
à un algorithme itératif dû à Gau\ss{} et exposé dans \NTS{réf}. \\

L'égalité $A_{n-1}^2 - kNB_{n-1}^2 = (-1)^n Q_n$ donne un critère pour
sélectionner les premiers de la base de factorisation : les premiers $p$
divisant $Q_n$ vérifient nécessairement \[ \left(\frac{kN}{p} \right) = 0 
\text{ ou } 1 \] En effet, supposons qu'un premier $p$ divise $Q_n$. 
On a alors $ A_{n-1}^2 \equiv kNB_{n-1}^2 \pmod{p}$. Comme
$\pgcd(A_{n-1},B_{n-1}) = 1$, $p$ ne peut pas diviser $B_{n-1}$ (sinon
$A_{n-1}^2 \equiv 0 \pmod{p}$ et $p$ diviserait aussi $A_{n-1}$). $B_{n-1}$ 
est donc inversible modulo $p$ et $\left( \frac{A_{n-1}}{B_{n-1}}\right )^2 
\equiv kN \pmod{p}$.\\ 

\subsubsection{Quelques éléments pour appréhender la complexité de la méthode}

